library(tidyverse)
library(dplyr)


dowker_cosheaf <- function(df,left_var,right_var){
  df %>%
    ungroup() %>%
    select({{left_var}},{{right_var}}) %>%
    nest(simplex={{left_var}}) %>%
    group_by(simplex) %>%
    nest(costalk={{right_var}}) %>%
    mutate(weight=sapply(costalk,function(x){nrow(x)}),
           dimension=sapply(simplex,function(x){nrow(x)-1})) %>%
    ungroup()
}

#lots of things to look at/rework and change variable names, etc. 
